---
layout: default
title: Update Spreadsheet
---
<h1>Update</h1>
<script type="text/javascript">

    // Reset the cookie manually
    //Cookies.expire('token');

    var $key = getUrlVar('key');
    var $resource = getUrlVar('worksheet');
    var $oAuthToken = getUrlVar('token');

    var $yaml_store = "";
    var $org = '{{ site.github_user }}';
    var $repo = '{{ site.github_repo }}';

    if($oAuthToken !='')
      {
      // Setting a cookie value
      Cookies.set('token', $oAuthToken);
      // Set with expiration
      // Cookies.set('token', $oAuthToken, { expires: '01/01/2017' });
      }

    // Grab the token from cookie
    $oAuthToken = Cookies.get('token');

    $(document).ready( function() {
      Tabletop.init( { key: $key,
                       callback: showInfo,
                       wanted: [ $resource ],
                       debug: true } )
    })

    console.log($resource);

    function showInfo(data, tabletop) {

      $products = new Array();

      $("#table_info").text("We found the tables " + tabletop.model_names.join(", "));

      $.each( tabletop.sheets(), function(i, sheet) {
        $("#table_info").append("<p>" + sheet.name + " has " + sheet.column_names.join(", ") + "</p>");
      });

      $product = tabletop.sheets($resource).all();

      $count = 0;
      $total_count = $product.length;
      $.each( tabletop.sheets($resource).all(), function(i, service) {
        $.each(service, function($key, $value) {
          console.log($key + ' == ' + $value);
        });

      });

    }

</script>
<textarea cols="10" rows="5" id="source" style="border: 1px solid #000; width: 100%; height: 350px;"></textarea>
