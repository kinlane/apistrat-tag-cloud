---
layout: default
title: Update Spreadsheet
---
<h1>Update</h1>
<script type="text/javascript">

    // Reset the cookie manually
    //Cookies.expire('token');

    var $key = getUrlVar('key');
    var $resource = getUrlVar('worksheet');
    var $oAuthToken = getUrlVar('token');

    var $yaml_store = "";
    var $org = '{{ site.github_user }}';
    var $repo = '{{ site.github_repo }}';

    if($oAuthToken !='')
      {
      // Setting a cookie value
      Cookies.set('token', $oAuthToken);
      // Set with expiration
      // Cookies.set('token', $oAuthToken, { expires: '01/01/2017' });
      }

    // Grab the token from cookie
    $oAuthToken = Cookies.get('token');

    $(document).ready( function() {
      Tabletop.init( { key: $key,
                       callback: showInfo,
                       wanted: [ $resource ],
                       debug: true } )
    })

    console.log($resource);

    function showInfo(data, tabletop) {

      $products = new Array();

      $("#table_info").text("We found the tables " + tabletop.model_names.join(", "));

      $.each( tabletop.sheets(), function(i, sheet) {
        $("#table_info").append("<p>" + sheet.name + " has " + sheet.column_names.join(", ") + "</p>");
      });

      $product = tabletop.sheets($resource).all();

      $all_words = {};
      $count = 0;
      $total_count = $product.length;
      $.each( tabletop.sheets($resource).all(), function(i, service) {

        if($count<2)
          {
          $title = service['Title'];
          $abstract = service['Abstract'];
          console.log($title);


          $title_array = $title.split(" ");
          foreach($title_array as $word)
            {

            //console.log($word);
            $word_exist = 0;
            $word_index = 0;
            for ($word_index = 0; $word_index = $all_words.length; $word_index++) {
              {
              if(main_word[word_index]['word'] == word)
                {
                console.log("EXISTING: "+ $word);
                $word_exist=1;
                $all_words[$word_index]['count'] = main_word['count']+1;
                }
              }

            if($word_exist==1)
              {

              }
            else
              {
              $this_word = {};
              $this_word['word'] = $word;
              $this_word['count'] = 1;
              $products.push($p);
              }

            }

          $count++;

          if($count==$total_count)
            {
            for ($word_index = 0; $word_index = $all_words.length; $word_index++) {
              {
              $word = $main_word[word_index]['word'];
              $word_count = $main_word[word_index]['count'];
              console.log($word + ' = ' + $word_count);
              }
            }

          }
      });

    }

</script>
<textarea cols="10" rows="5" id="source" style="border: 1px solid #000; width: 100%; height: 350px;"></textarea>
